---
alwaysApply: false
description: "System-specific usage guide: CoreSystem, CombatSystem, CharacterSystem, SaveSystem patterns (reference when needed)"
---
# RougeShool ì‹œìŠ¤í…œë³„ í•µì‹¬ ê°€ì´ë“œ (System-Specific Guide)

> ëª©ì : AI-ì‚¬ìš©ì í˜‘ì—…ì„ ìœ„í•œ ì‹œìŠ¤í…œë³„ í•µì‹¬ ì‚¬ìš©ë²•. ì‹¤ì œ ì½”ë“œ ì˜ˆì‹œ ìœ„ì£¼ë¡œ êµ¬ì„±.

## ğŸ—ï¸ CoreSystem í•µì‹¬ ì‚¬ìš©ë²•

### ìë™ ì´ˆê¸°í™” ì‹œìŠ¤í…œ (ICoreSystemInitializable)
```csharp
public class MySystem : MonoBehaviour, ICoreSystemInitializable
{
    public bool IsInitialized { get; private set; } = false;
    
    public IEnumerator Initialize()
    {
        GameLogger.LogInfo($"{GetType().Name} ì´ˆê¸°í™” ì‹œì‘", GameLogger.LogCategory.UI);
        yield return InitializeAsync();
        IsInitialized = true;
        GameLogger.LogInfo($"{GetType().Name} ì´ˆê¸°í™” ì™„ë£Œ", GameLogger.LogCategory.UI);
    }
    
    public void OnInitializationFailed()
    {
        GameLogger.LogError($"{GetType().Name} ì´ˆê¸°í™” ì‹¤íŒ¨", GameLogger.LogCategory.Error);
        IsInitialized = false;
    }
}
```

### ì”¬ ì „í™˜ (SceneTransitionManager)
```csharp
public class MySceneController : MonoBehaviour
{
    [Inject] private SceneTransitionManager sceneTransitionManager;

    public async void LoadBattleScene()
    {
        // ë¹„ë™ê¸° ì”¬ ì „í™˜
        await sceneTransitionManager.TransitionToBattleScene();
    }

    public void CheckTransitionState()
    {
        // ì „í™˜ ìƒíƒœ í™•ì¸
        if (sceneTransitionManager.IsTransitioning)
        {
            GameLogger.LogWarning("ì”¬ ì „í™˜ ì¤‘ì…ë‹ˆë‹¤", GameLogger.LogCategory.UI);
        }
    }
}
```

### ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œ (AudioManager)
```csharp
public class AudioController : MonoBehaviour
{
    [Inject] private IAudioManager audioManager;

    public void PlayBackgroundMusic()
    {
        // BGM ì¬ìƒ (í˜ì´ë“œ ì¸ ì˜µì…˜)
        AudioClip bgmClip = Resources.Load<AudioClip>("Sounds/BGM/MainTheme");
        audioManager.PlayBGM(bgmClip, true);
    }

    public void PlayButtonSound()
    {
        // SFX ì¬ìƒ
        AudioClip buttonClick = Resources.Load<AudioClip>("Sounds/SFX/ButtonClick");
        audioManager.PlaySFX(buttonClick);

        // SFX ì¬ìƒ (í’€ë§ ì‚¬ìš©)
        audioManager.PlaySFXWithPool(buttonClick, 1.0f, 8);
    }
}
```

### ì €ì¥ ì‹œìŠ¤í…œ (SaveManager)
```csharp
public class SaveController : MonoBehaviour
{
    [Inject] private ISaveManager saveManager;

    public async void SaveGame()
    {
        // ìë™ ì €ì¥ ì‹œìŠ¤í…œ
        await saveManager.SaveCurrentScene();
    }

    public void SaveAudioPreferences()
    {
        // ì˜¤ë””ì˜¤ ì„¤ì • ì €ì¥/ë¡œë“œ
        saveManager.SaveAudioSettings(0.6f, 1.0f);
        var (bgm, sfx) = saveManager.LoadAudioSettings(0.7f, 1.0f);
    }
}
```

## âš”ï¸ CombatSystem í•µì‹¬ ì‚¬ìš©ë²•

### ìƒˆë¡œìš´ 5ìŠ¬ë¡¯ ì‹œìŠ¤í…œ (í˜„ì¬ êµ¬í˜„)
```csharp
public class CombatController : MonoBehaviour
{
    [Inject] private TurnManager turnManager;
    [Inject] private CombatExecutionManager executionManager;

    public void StartCombat()
    {
        // ì…‹ì—… í˜ì´ì¦ˆ ì‹œì‘
        turnManager.StartSetupPhase();

        // ì…‹ì—… ë‹¨ê³„ë³„ ì¹´ë“œ ë°°ì¹˜ (í”Œë ˆì´ì–´ ìš°ì„ )
        turnManager.ProceedSetupStep(CombatSlotPosition.WAIT_SLOT_4, SlotOwner.Player);
        turnManager.ProceedSetupStep(CombatSlotPosition.WAIT_SLOT_3, SlotOwner.Player);
        turnManager.ProceedSetupStep(CombatSlotPosition.WAIT_SLOT_4, SlotOwner.Enemy);

        // ì…‹ì—… ì™„ë£Œ í›„ ì „íˆ¬ í˜ì´ì¦ˆë¡œ ì „í™˜
        turnManager.CompleteSetup();
    }

    public void ExecuteTurn()
    {
        // í˜„ì¬ í˜ì´ì¦ˆ í™•ì¸
        CombatPhase currentPhase = turnManager.GetCurrentPhase(); // Setup, Battle, End

        // ì „íˆ¬ ìŠ¬ë¡¯ì—ì„œ ì¹´ë“œ ì‹¤í–‰
        executionManager.ExecuteCardInBattleSlot();

        // ìŠ¬ë¡¯ ì´ë™ (ìƒˆë¡œìš´ ì‹œìŠ¤í…œ)
        executionManager.MoveSlotsForwardNew();

        // í„´ ì™„ë£Œ (ì „íˆ¬ ìŠ¬ë¡¯ì—ì„œ ì¹´ë“œ ì‚¬ìš© ì‹œì—ë§Œ)
        turnManager.CompleteTurn();

        // í˜„ì¬ í„´ íƒ€ì… í™•ì¸ (ìƒˆë¡œìš´ ì‹œìŠ¤í…œ)
        TurnType currentTurn = turnManager.GetCurrentTurnTypeNew(); // Player ë˜ëŠ” Enemy
    }
}
```

### ë ˆê±°ì‹œ 4ìŠ¬ë¡¯ ì‹œìŠ¤í…œ (í˜¸í™˜ì„± ìœ ì§€)
```csharp
public class LegacyCombatController : MonoBehaviour
{
    [Inject] private TurnManager turnManager;
    [Inject] private CombatExecutionManager executionManager;

    public void ExecutePlayerCard(ISkillCard playerCard)
    {
        // í˜„ì¬ í„´ íŒì • (1ë²ˆ ìŠ¬ë¡¯ ê¸°ì¤€)
        var turnType = turnManager.GetCurrentTurnType(); // Player ë˜ëŠ” Enemy

        // í”Œë ˆì´ì–´ê°€ 1ë²ˆ ìŠ¬ë¡¯ì— ì¹´ë“œë¥¼ ì˜¬ë¦¬ëŠ” ìˆœê°„ ì¦‰ì‹œ ì‹¤í–‰
        executionManager.ExecuteImmediately(playerCard, CombatSlotPosition.SLOT_1);

        // ì‹¤í–‰ ì¢…ë£Œ í›„ ë‚´ë¶€ì ìœ¼ë¡œ ìŠ¬ë¡¯ ì´ë™(2â†’1, 3â†’2, 4â†’3) â†’ 1ë²ˆì´ ì  ì¹´ë“œë¼ë©´ ì¦‰ì‹œ ì  ì‹¤í–‰
    }

    public void RegisterEnemyCard(SkillCardDefinition enemyCardDefinition)
    {
        // ì  ì¹´ë“œ ì˜ˆì•½(í•„ìš” ì‹œ)
        turnManager.RegisterEnemyCardInSlot4(enemyCardDefinition);
    }

    public void ApplyGuard()
    {
        // ê°€ë“œ íš¨ê³¼ ì ìš©(ë‹¤ìŒ ì  ì¹´ë“œ 1ì¥ ë¬´íš¨í™”)
        turnManager.ApplyGuardEffect();
    }
}
```

## ğŸ‘¤ CharacterSystem í•µì‹¬ ì‚¬ìš©ë²•

### í”Œë ˆì´ì–´ ìºë¦­í„° ê´€ë¦¬ (PlayerCharacter + PlayerResourceManager)
```csharp
public class PlayerController : MonoBehaviour
{
    [Inject] private IPlayerCharacter playerCharacter;
    [Inject] private IPlayerResourceManager resourceManager;

    public void InitializePlayer(PlayerCharacterData playerData)
    {
        // ìºë¦­í„° ì´ˆê¸°í™”
        playerCharacter.Initialize(playerData);

        // ë¦¬ì†ŒìŠ¤ ê´€ë¦¬ (í™”ì‚´/ë§ˆë‚˜)
        resourceManager.Initialize(playerData);
    }

    public void UseSkill(int resourceCost)
    {
        // ë¦¬ì†ŒìŠ¤ ì†Œëª¨ ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸
        if (resourceManager.CanConsumeResource(resourceCost))
        {
            resourceManager.ConsumeResource(resourceCost);
            GameLogger.LogInfo($"ë¦¬ì†ŒìŠ¤ ì†Œëª¨: {resourceManager.ResourceName} {resourceCost}ê°œ", GameLogger.LogCategory.Character);
        }
    }

    public void RecoverResource(int amount)
    {
        // ë¦¬ì†ŒìŠ¤ íšŒë³µ
        resourceManager.RestoreResource(amount);

        // ë¦¬ì†ŒìŠ¤ ìƒíƒœ ì¡°íšŒ
        int currentResource = resourceManager.CurrentResource;
        int maxResource = resourceManager.MaxResource;
        string resourceName = resourceManager.ResourceName;
    }
}
```

### ìƒˆë¡œìš´ í”Œë ˆì´ì–´ UI ì‹œìŠ¤í…œ (ëª¨ë˜ ìŠ¤íƒ€ì¼)
```csharp
// PlayerCharacterUIController ì´ˆê¸°í™” ë° ì‚¬ìš©
PlayerCharacterUIController uiController = playerCharacter.GetComponent<PlayerCharacterUIController>();

// ìºë¦­í„° ì´ˆê¸°í™” (PlayerCharacter.InitializeCharacterì—ì„œ ìë™ í˜¸ì¶œë¨)
uiController.Initialize(playerCharacter);

// HP ì—…ë°ì´íŠ¸ (PlayerCharacter.TakeDamage/Healì—ì„œ ìë™ í˜¸ì¶œë¨)
uiController.UpdateHP(currentHP, maxHP);
uiController.OnTakeDamage(damageAmount);
uiController.OnHeal(healAmount);

// ë¦¬ì†ŒìŠ¤ ì—…ë°ì´íŠ¸ (íƒ€ì…ë³„ UI ìë™ í‘œì‹œ)
uiController.UpdateResource(currentResource, maxResource);

// ë²„í”„/ë””ë²„í”„ ì•„ì´ì½˜ ê´€ë¦¬
uiController.AddBuffDebuffIcon(buffIcon, duration, isBuff);
uiController.RemoveBuffDebuffIcon(buffIcon);
uiController.ClearAllBuffDebuffIcons();

// ë°ì´í„° ê¸°ë°˜ ë¬¸ì–‘ ì„¤ì • (PlayerCharacterData.Emblem ì‚¬ìš©)
// ë¬¸ì–‘ì´ ì„¤ì •ë˜ì§€ ì•Šì€ ê²½ìš° ìë™ìœ¼ë¡œ ê¸°ë³¸ ë¬¸ì–‘ ë¡œë“œ
```

### ì  ìºë¦­í„° ê´€ë¦¬ (EnemyManager + EnemySpawnerManager)
```csharp
public class EnemyController : MonoBehaviour
{
    [Inject] private IEnemyManager enemyManager;
    [Inject] private IEnemySpawnerManager spawnerManager;

    public void SpawnEnemy(EnemyCharacterData enemyData)
    {
        // EnemySpawnerManagerë¥¼ í†µí•œ ì  ìŠ¤í°
        var spawnResult = spawnerManager.SpawnEnemy(enemyData);
        if (spawnResult.IsSuccess)
        {
            GameLogger.LogInfo($"ì  ìŠ¤í° ì„±ê³µ: {spawnResult.Enemy.CharacterName}", GameLogger.LogCategory.Character);

            // ì  ìºë¦­í„° ë“±ë¡
            enemyManager.RegisterEnemy(spawnResult.Enemy);
        }
    }

    public void GetCurrentEnemy()
    {
        // í˜„ì¬ ì  ìºë¦­í„° ì¡°íšŒ
        IEnemyCharacter currentEnemy = enemyManager.GetCurrentEnemy();
    }

    public void ClearCurrentEnemy()
    {
        // ì  ìºë¦­í„° ë“±ë¡ í•´ì œ
        enemyManager.UnregisterEnemy();

        // ì  ìºë¦­í„° ì´ˆê¸°í™”
        enemyManager.ClearEnemy();
    }
}
```

## ğŸƒ SkillCardSystem í•µì‹¬ ì‚¬ìš©ë²•

### í†µí•© ë°ì´í„° ëª¨ë¸
```csharp
// SkillCardFactoryë¥¼ í†µí•œ í†µí•© ì¹´ë“œ ìƒì„±
SkillCardFactory factory = new SkillCardFactory();
SkillCardDefinition definition = Resources.Load<SkillCardDefinition>("SkillCards/Fireball");

// í”Œë ˆì´ì–´ ì¹´ë“œ ìƒì„±
ISkillCard playerCard = factory.CreateFromDefinition(definition, Owner.Player, "í”Œë ˆì´ì–´");

// ì  ì¹´ë“œ ìƒì„±
ISkillCard enemyCard = factory.CreateFromDefinition(definition, Owner.Enemy, "ì ");
```

### ì¹´ë“œ ìˆœí™˜ ì‹œìŠ¤í…œ
```csharp
public class CardManager : MonoBehaviour
{
    [Inject] private ICardCirculationSystem circulationSystem;

    public void InitializeCards(List<ISkillCard> initialCards)
    {
        circulationSystem.Initialize(initialCards);
    }

    public void DrawCards()
    {
        List<ISkillCard> drawnCards = circulationSystem.DrawCardsForTurn();
    }

    public void UseCard(ISkillCard usedCard)
    {
        circulationSystem.MoveCardToUsedStorage(usedCard);
    }
}
```

## ğŸ’¾ SaveSystem í•µì‹¬ ì‚¬ìš©ë²•

### ìë™ ì €ì¥ ì‹œìŠ¤í…œ
```csharp
public class GameSaveController : MonoBehaviour
{
    [Inject] private IAutoSaveManager autoSaveManager;
    [Inject] private ISaveEventTrigger saveEventTrigger;

    public void TriggerAutoSave(string eventType)
    {
        // íŠ¹ì • ì¡°ê±´ìœ¼ë¡œ ìë™ ì €ì¥ íŠ¸ë¦¬ê±°
        autoSaveManager.TriggerAutoSave(eventType);
    }

    public async void ManualSave()
    {
        // ìˆ˜ë™ ì €ì¥
        await autoSaveManager.SaveGameState("ManualSave");
    }

    public void OnTurnComplete()
    {
        // ì´ë²¤íŠ¸ ê¸°ë°˜ ì €ì¥
        saveEventTrigger.OnTurnCompleted();
    }

    public void OnStageComplete()
    {
        saveEventTrigger.OnStageCompleted();
    }
}
```

## âš ï¸ ì£¼ì˜ì‚¬í•­ ë° ê¸ˆì§€ì‚¬í•­

### AnimationSystem ê´€ë ¨
- **ì ˆëŒ€ ê¸ˆì§€**: AnimationSystem ì°¸ì¡° ë˜ëŠ” ì‚¬ìš©
- **í˜„ì¬ ìƒíƒœ**: ëª¨ë“  AnimationSystem ê´€ë ¨ ì½”ë“œ ì œê±° ì™„ë£Œ
- **ì„ì‹œ ì²˜ë¦¬**: ì• ë‹ˆë©”ì´ì…˜ í˜¸ì¶œ ë¶€ë¶„ì€ Debug.Logë¡œ ëŒ€ì²´ë¨

### ë ˆê±°ì‹œ í˜¸í™˜ì„±
- **SLOT_1/SLOT_2**: BATTLE_SLOT/WAIT_SLOT_1ë¡œ ì „í™˜ ì™„ë£Œ
- **CombatSecondAttackState**: ì œê±° ì™„ë£Œ, ë‹¨ì¼ CombatAttackStateë¡œ í†µí•©
- **difficultyMultiplier**: StageManagerì—ì„œ ì œê±° ì™„ë£Œ

### ì„±ëŠ¥ ìµœì í™”
- **DOTween Pro**: ëª¨ë“  ì• ë‹ˆë©”ì´ì…˜ì€ DOTween Pro ìš°ì„  ì‚¬ìš©
- **Zenject DI**: ì˜ì¡´ì„± ì£¼ì…ìœ¼ë¡œ ëŠìŠ¨í•œ ê²°í•© êµ¬í˜„
- **ë©”ëª¨ë¦¬ ê´€ë¦¬**: ë¶ˆí•„ìš”í•œ ì°¸ì¡° í•´ì œ, ê°ì²´ í’€ë§ í™œìš©

## ğŸ“ ë³€ê²½ ê¸°ë¡
- 2025-01-27 | Maintainer | í† í° ìµœì í™” ë° AI-ì‚¬ìš©ì í˜‘ì—… ê·œì¹™ ê°„ì†Œí™” | ë¬¸ì„œ