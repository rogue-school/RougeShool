---
description: "CharacterSystem ê°œë°œ ê°€ì´ë“œ ë° ê·œì¹™ - Unity 2D ìºë¦­í„° í†µí•© ê´€ë¦¬"
globs: ["Assets/Script/CharacterSystem/**/*.cs"]
rule_id: character_system_rules
version: 1.2.0
alwaysApply: true
---

# CharacterSystem ê°œë°œ ê·œì¹™

## ğŸ“‹ ì‹œìŠ¤í…œ ê°œìš”
CharacterSystemì€ ê²Œì„ì˜ ëª¨ë“  ìºë¦­í„°(í”Œë ˆì´ì–´, ì )ë¥¼ ê´€ë¦¬í•˜ëŠ” ì‹œìŠ¤í…œì…ë‹ˆë‹¤. ìºë¦­í„°ì˜ ê¸°ë³¸ ì†ì„±, ìƒíƒœ, í–‰ë™ì„ í†µí•©ì ìœ¼ë¡œ ê´€ë¦¬í•˜ë©°, League of Legends ìŠ¤íƒ€ì¼ì˜ í”Œë ˆì´ì–´ UI ì‹œìŠ¤í…œê³¼ ë²„í”„/ë””ë²„í”„ ì•„ì´ì½˜ ì‹œìŠ¤í…œì„ ì œê³µí•©ë‹ˆë‹¤.

### ìµœê·¼ ë³€ê²½(ìš”ì•½)
- **í”Œë ˆì´ì–´ UI ì¼ì›í™”**: `PlayerCharacterUIController` ì¤‘ì‹¬ êµ¬ì¡°ë¡œ í†µí•©, í˜¸í™˜ìš© `SetTarget(ICharacter)` ì œê³µ
- **ì  UI ë¶„ë¦¬**: `EnemyCharacterUIController` ì¶”ê°€(Hp/ë²„í”„ ìµœì†Œ UI)
- **ë ˆê±°ì‹œ ì œê±°**: `CharacterUIController` ì „ë©´ ì œê±° ë° ì°¸ì¡° ì •ë¦¬, `CharacterSlotUI`ì˜ UI ìë™ ì—°ê²° ë¡œì§ ì‚­ì œ
- **ê³µìœ  ì´ë²¤íŠ¸ ì¶”ê°€**: `ICharacter/CharacterBase`ì— HP/ê°€ë“œ/ë²„í”„ ì´ë²¤íŠ¸ ë° `GetBuffs()` ì¶”ê°€
- **DOTween/DI ì •ë¦¬**: UI ì• ë‹ˆë©”ì´ì…˜ ë° Zenject ì˜ì¡´ì„± ì£¼ì… ì •ë¹„

## ğŸ—ï¸ í´ë” êµ¬ì¡° ê·œì¹™
```
CharacterSystem/
â”œâ”€â”€ Core/             # ìºë¦­í„° í•µì‹¬ ë¡œì§ (4ê°œ íŒŒì¼)
â”œâ”€â”€ Data/             # ìºë¦­í„° ë°ì´í„° (4ê°œ íŒŒì¼)
â”œâ”€â”€ Interface/        # ìºë¦­í„° ì¸í„°í˜ì´ìŠ¤ (8ê°œ íŒŒì¼)
â”œâ”€â”€ Manager/          # ìºë¦­í„° ë§¤ë‹ˆì € (3ê°œ íŒŒì¼)
â”œâ”€â”€ Intialization/    # ìºë¦­í„° ì´ˆê¸°í™” (6ê°œ íŒŒì¼) [ì£¼ì˜: í´ë”ëª… ì˜¤íƒ€ - Initializationì´ì–´ì•¼ í•¨]
â”œâ”€â”€ Slot/             # ìºë¦­í„° ìŠ¬ë¡¯ (1ê°œ íŒŒì¼)
â”œâ”€â”€ UI/               # ìºë¦­í„° UI (4ê°œ íŒŒì¼)
â””â”€â”€ Utility/          # ìºë¦­í„° ìœ í‹¸ë¦¬í‹° (4ê°œ íŒŒì¼)
```

## ğŸ“ ì£¼ìš” ì»´í¬ë„ŒíŠ¸ ê·œì¹™

### Core í´ë” ê·œì¹™ (4ê°œ íŒŒì¼)
- **CharacterBase.cs**: ëª¨ë“  ìºë¦­í„°ì˜ ê¸°ë³¸ í´ë˜ìŠ¤ (MonoBehaviour ìƒì†)
- **PlayerCharacter.cs**: í”Œë ˆì´ì–´ ìºë¦­í„° êµ¬í˜„
- **EnemyCharacter.cs**: ì  ìºë¦­í„° êµ¬í˜„
- **CharacterState.cs**: ìºë¦­í„° ìƒíƒœ ê´€ë¦¬

### Data í´ë” ê·œì¹™ (4ê°œ íŒŒì¼)
- **PlayerCharacterData.cs**: í”Œë ˆì´ì–´ ìºë¦­í„° ë°ì´í„° (ScriptableObject)
- **EnemyCharacterData.cs**: ì  ìºë¦­í„° ë°ì´í„° (ScriptableObject)
- **PlayerCharacterType.cs**: í”Œë ˆì´ì–´ ìºë¦­í„° íƒ€ì… ì—´ê±°í˜•
- **PlayerCharacterTypeHelper.cs**: í”Œë ˆì´ì–´ ìºë¦­í„° íƒ€ì… í—¬í¼

### Interface í´ë” ê·œì¹™ (8ê°œ íŒŒì¼)
- **ICharacter.cs**: ìºë¦­í„° ê¸°ë³¸ ì¸í„°í˜ì´ìŠ¤
- **ICharacterData.cs**: ìºë¦­í„° ë°ì´í„° ì¸í„°í˜ì´ìŠ¤
- **ICharacterState.cs**: ìºë¦­í„° ìƒíƒœ ì¸í„°í˜ì´ìŠ¤
- **ICharacterAction.cs**: ìºë¦­í„° í–‰ë™ ì¸í„°í˜ì´ìŠ¤
- **ICharacterEffect.cs**: ìºë¦­í„° íš¨ê³¼ ì¸í„°í˜ì´ìŠ¤
- **ICharacterUI.cs**: ìºë¦­í„° UI ì¸í„°í˜ì´ìŠ¤
- **IPlayerResourceManager.cs**: í”Œë ˆì´ì–´ ë¦¬ì†ŒìŠ¤ ê´€ë¦¬ ì¸í„°í˜ì´ìŠ¤
- **ICharacterDeathListener.cs**: ìºë¦­í„° ì‚¬ë§ ë¦¬ìŠ¤ë„ˆ ì¸í„°í˜ì´ìŠ¤

### Manager í´ë” ê·œì¹™ (3ê°œ íŒŒì¼)
- **PlayerManager.cs**: í”Œë ˆì´ì–´ ìºë¦­í„° ë§¤ë‹ˆì € (ì‹±ê¸€í†¤)
- **EnemyManager.cs**: ì  ìºë¦­í„° ë§¤ë‹ˆì € (ì‹±ê¸€í†¤)
- **PlayerResourceManager.cs**: í”Œë ˆì´ì–´ ë¦¬ì†ŒìŠ¤ ê´€ë¦¬ ë§¤ë‹ˆì €

### Intialization í´ë” ê·œì¹™ (6ê°œ íŒŒì¼) [í´ë”ëª… ì˜¤íƒ€ ì£¼ì˜]
- **EnemyCharacterInitializer.cs**: ì  ìºë¦­í„° ì´ˆê¸°í™”
- **EnemyHandInitializer.cs**: ì  í•¸ë“œ ì´ˆê¸°í™”
- **EnemyInitializer.cs**: ì  ì´ˆê¸°í™” í†µí•© ê´€ë¦¬
- **HandInitializer.cs**: í•¸ë“œ ì´ˆê¸°í™” ê¸°ë³¸ í´ë˜ìŠ¤
- **PlayerCharacterInitializer.cs**: í”Œë ˆì´ì–´ ìºë¦­í„° ì´ˆê¸°í™”
- **PlayerSkillCardInitializer.cs**: í”Œë ˆì´ì–´ ìŠ¤í‚¬ì¹´ë“œ ì´ˆê¸°í™”

### UI í´ë” ê·œì¹™ (4ê°œ íŒŒì¼)
- **CharacterSlotUI.cs**: ìºë¦­í„° ìŠ¬ë¡¯ UI (UI ìë™ ì—°ê²° ë¡œì§ ì œê±°)
- ~~CharacterUIController.cs~~: [ì‚­ì œë¨]
- **PlayerCharacterUIController.cs**: í”Œë ˆì´ì–´ í†µí•© UI ì»¨íŠ¸ë¡¤ëŸ¬
- **EnemyCharacterUIController.cs**: ì  ì „ìš© UI ì»¨íŠ¸ë¡¤ëŸ¬

### Utility í´ë” ê·œì¹™ (4ê°œ íŒŒì¼)
- **CharacterDeathHandler.cs**: ìºë¦­í„° ì‚¬ë§ ì²˜ë¦¬
- **CardRegistrar.cs**: ì¹´ë“œ ë“±ë¡ê¸°
- **CardValidator.cs**: ì¹´ë“œ ê²€ì¦ê¸°
- **EnemySpawnResult.cs**: ì  ìŠ¤í° ê²°ê³¼

## ğŸ¯ ê°œë°œ ê·œì¹™

### 1. ìºë¦­í„° ê¸°ë³¸ ì†ì„± ê·œì¹™
- **ì²´ë ¥ (Health)**: ìºë¦­í„°ì˜ ìƒëª…ë ¥ (currentHP, maxHP)
- **ê°€ë“œ (Guard)**: ë°ë¯¸ì§€ ê°ì†Œ ë°©ì–´ë ¥ (currentGuard, isGuarded)
- **ë¦¬ì†ŒìŠ¤ (Resource)**: ìºë¦­í„° íƒ€ì…ë³„ ë¦¬ì†ŒìŠ¤ (Bow: í™”ì‚´, Staff: ë§ˆë‚˜, Sword: 0)
- **í„´ íš¨ê³¼ (PerTurnEffect)**: í„´ë§ˆë‹¤ ì ìš©ë˜ëŠ” íš¨ê³¼ë“¤

### 2. í”Œë ˆì´ì–´ ìºë¦­í„° íƒ€ì… ê·œì¹™
- **ê²€ (Sword)**: ê·¼ì ‘ ì „íˆ¬ íŠ¹í™”
- **í™œ (Bow)**: ì›ê±°ë¦¬ ì „íˆ¬ íŠ¹í™”, í™”ì‚´ ë¦¬ì†ŒìŠ¤ ê´€ë¦¬
- **ì§€íŒ¡ì´ (Staff)**: ë§ˆë²• ì „íˆ¬ íŠ¹í™”, ë§ˆë‚˜ ë¦¬ì†ŒìŠ¤ ê´€ë¦¬

### 3. ìƒíƒœ ê´€ë¦¬ ê·œì¹™
- **ìƒì¡´ ìƒíƒœ**: ì‚´ì•„ìˆìŒ/ì£½ìŒ (bool isAlive)
- **íš¨ê³¼ ìƒíƒœ**: ë²„í”„/ë””ë²„í”„ íš¨ê³¼ (List<Effect>)
- **ìƒíƒœ ì „í™˜**: ì´ë²¤íŠ¸ ê¸°ë°˜ ìƒíƒœ ë³€ê²½

### 4. í–‰ë™ ì‹œìŠ¤í…œ ê·œì¹™
- **ê¸°ë³¸ ê³µê²©**: ì¼ë°˜ì ì¸ ê³µê²© í–‰ë™
- **ìŠ¤í‚¬ ì‚¬ìš©**: íŠ¹ìˆ˜ ëŠ¥ë ¥ ì‚¬ìš©
- **í–‰ë™ ê²€ì¦**: í–‰ë™ ê°€ëŠ¥ ì—¬ë¶€ ì‚¬ì „ ê²€ì¦

### 5. ë¦¬ì†ŒìŠ¤ ê´€ë¦¬ ê·œì¹™
- **í™”ì‚´ (Arrows)**: í™œ ìºë¦­í„° ì „ìš© ë¦¬ì†ŒìŠ¤
- **ë§ˆë‚˜ (Mana)**: ì§€íŒ¡ì´ ìºë¦­í„° ì „ìš© ë¦¬ì†ŒìŠ¤
- **ë¦¬ì†ŒìŠ¤ ì†Œëª¨**: ìŠ¤í‚¬ ì‚¬ìš© ì‹œ ë¦¬ì†ŒìŠ¤ ì†Œëª¨
- **ë¦¬ì†ŒìŠ¤ ë³µêµ¬**: í„´ ì¢…ë£Œ ì‹œ ë¦¬ì†ŒìŠ¤ ë³µêµ¬

### 6. ì´ˆê¸°í™” ì‹œìŠ¤í…œ ê·œì¹™
- **ìë™ ì´ˆê¸°í™”**: ìºë¦­í„° ìƒì„± ì‹œ ìë™ ì„¤ì •
- **ìŠ¤í‚¬ì¹´ë“œ ì´ˆê¸°í™”**: ìºë¦­í„°ë³„ ìŠ¤í‚¬ì¹´ë“œ ë± ì„¤ì •
- **Zenject DI**: ì˜ì¡´ì„± ì£¼ì…ì„ í†µí•œ ì´ˆê¸°í™”

### 7. ìƒˆë¡œìš´ í”Œë ˆì´ì–´ UI ì‹œìŠ¤í…œ ê·œì¹™
- **í†µí•© UI ì»¨íŠ¸ë¡¤ëŸ¬**: `PlayerCharacterUIController`ë¥¼ í†µí•œ ëª¨ë“  í”Œë ˆì´ì–´ UI í†µí•© ê´€ë¦¬
- **League of Legends ìŠ¤íƒ€ì¼**: HP ë°”(ìœ„), íŠ¹ìˆ˜ ë¦¬ì†ŒìŠ¤ ë°”(ì•„ë˜) êµ¬ì¡°
- **ìºë¦­í„° ì •ë³´ í‘œì‹œ**: ì´ˆìƒí™”, ë¬¸ì–‘, ì´ë¦„, HP/MP ë°” í‘œì‹œ
- **ë¦¬ì†ŒìŠ¤ íƒ€ì…ë³„ UI**: ê²€(ë¹ˆ ê³µê°„), í™œ(í™”ì‚´), ì§€íŒ¡ì´(ë§ˆë‚˜) íƒ€ì…ë³„ UI í‘œì‹œ
- **ë²„í”„/ë””ë²„í”„ ì•„ì´ì½˜**: ì‹œê°ì  íš¨ê³¼ í‘œì‹œ ë° ì§€ì†ì‹œê°„ ê´€ë¦¬
- **DOTween ì• ë‹ˆë©”ì´ì…˜**: HP/MP ë°” ì „í™˜ ì‹œ ë¶€ë“œëŸ¬ìš´ ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼
- **ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸**: ë°ë¯¸ì§€/ì¹˜ìœ  ì‹œ ì¦‰ì‹œ UI ë°˜ì˜

## ğŸ”§ ì‚¬ìš© ë°©ë²•

### ê¸°ë³¸ ì‚¬ìš©ë²•
```csharp
// ìºë¦­í„° ìƒì„± ë° ì´ˆê¸°í™”
PlayerCharacter player = Instantiate(playerPrefab);
player.Initialize(playerData);

EnemyCharacter enemy = Instantiate(enemyPrefab);
enemy.Initialize(enemyData);

// ìºë¦­í„° ìƒíƒœ í™•ì¸
if (player.IsAlive)
{
    player.Attack(enemy);
}
```

### ë§¤ë‹ˆì €ë¥¼ í†µí•œ ìºë¦­í„° ê´€ë¦¬
```csharp
// EnemyManagerë¥¼ í†µí•œ ì  ìºë¦­í„° ê´€ë¦¬
EnemyManager enemyManager = FindObjectOfType<EnemyManager>();

// ì  ìºë¦­í„° ë“±ë¡
enemyManager.RegisterEnemy(enemy);

// í˜„ì¬ ì  ìºë¦­í„° ì¡°íšŒ
IEnemyCharacter currentEnemy = enemyManager.GetCurrentEnemy();

// ì  ìºë¦­í„° ë“±ë¡ í•´ì œ
enemyManager.UnregisterEnemy();

// ì  ìºë¦­í„° ì´ˆê¸°í™”
enemyManager.ClearEnemy();
```

### ë¦¬ì†ŒìŠ¤ ê´€ë¦¬
```csharp
// PlayerResourceManagerë¥¼ í†µí•œ ë¦¬ì†ŒìŠ¤ ê´€ë¦¬
PlayerResourceManager resourceManager = FindObjectOfType<PlayerResourceManager>();

// ìºë¦­í„° ë°ì´í„°ë¡œ ì´ˆê¸°í™”
resourceManager.Initialize(playerData);

// ë¦¬ì†ŒìŠ¤ ì†Œëª¨ ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸
if (resourceManager.CanConsumeResource(5))
{
    resourceManager.ConsumeResource(5);
}

// ë¦¬ì†ŒìŠ¤ íšŒë³µ
resourceManager.RestoreResource(3);

// ë¦¬ì†ŒìŠ¤ ìƒíƒœ ì¡°íšŒ
int currentResource = resourceManager.CurrentResource;
int maxResource = resourceManager.MaxResource;
string resourceName = resourceManager.ResourceName;
```

### ìºë¦­í„° íƒ€ì…ë³„ íŠ¹ìˆ˜ ê¸°ëŠ¥
```csharp
// í”Œë ˆì´ì–´ ìºë¦­í„° íƒ€ì…ë³„ íŠ¹ìˆ˜ ê¸°ëŠ¥
if (player.CharacterType == PlayerCharacterType.Sword)
{
    // ê²€ ìºë¦­í„° íŠ¹ìˆ˜ ê¸°ëŠ¥
    player.SwordAttack();
}
else if (player.CharacterType == PlayerCharacterType.Bow)
{
    // í™œ ìºë¦­í„° íŠ¹ìˆ˜ ê¸°ëŠ¥ (í™”ì‚´ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©)
    if (resourceManager.CanConsumeResource(1))
    {
        resourceManager.ConsumeResource(1);
        player.BowAttack();
    }
}
else if (player.CharacterType == PlayerCharacterType.Staff)
{
    // ì§€íŒ¡ì´ ìºë¦­í„° íŠ¹ìˆ˜ ê¸°ëŠ¥ (ë§ˆë‚˜ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©)
    if (resourceManager.CanConsumeResource(2))
    {
        resourceManager.ConsumeResource(2);
        player.StaffAttack();
    }
}
```

### ìƒˆë¡œìš´ í”Œë ˆì´ì–´ UI ì‹œìŠ¤í…œ ì‚¬ìš©ë²•
```csharp
// PlayerCharacterUIController ì´ˆê¸°í™” ë° ì‚¬ìš©
PlayerCharacterUIController uiController = playerCharacter.GetComponent<PlayerCharacterUIController>();

// ìºë¦­í„° ì´ˆê¸°í™” (PlayerCharacter.InitializeCharacterì—ì„œ ìë™ í˜¸ì¶œë¨)
uiController.Initialize(playerCharacter);

// HP ì—…ë°ì´íŠ¸ (PlayerCharacter.TakeDamage/Healì—ì„œ ìë™ í˜¸ì¶œë¨)
uiController.UpdateHP(currentHP, maxHP);
uiController.OnTakeDamage(damageAmount);
uiController.OnHeal(healAmount);

// ë¦¬ì†ŒìŠ¤ ì—…ë°ì´íŠ¸
uiController.UpdateResource(currentResource, maxResource);

// ë²„í”„/ë””ë²„í”„ ì•„ì´ì½˜ ê´€ë¦¬
uiController.AddBuffDebuffIcon(buffIcon, duration, isBuff);
uiController.RemoveBuffDebuffIcon(buffIcon);
uiController.ClearAllBuffDebuffIcons();
```

### BuffDebuffIcon ì‚¬ìš©ë²•
```csharp
// ë²„í”„/ë””ë²„í”„ ì•„ì´ì½˜ ìƒì„± ë° ì„¤ì •
BuffDebuffIcon icon = Instantiate(buffDebuffIconPrefab, iconParent);
icon.SetupIcon(iconSprite, duration, isBuff);

// ì•„ì´ì½˜ ì—…ë°ì´íŠ¸
icon.UpdateDuration(remainingDuration);

// ì•„ì´ì½˜ ì œê±°
icon.RemoveIcon();
```

## ğŸ—ï¸ ì•„í‚¤í…ì²˜ íŒ¨í„´

### 1. ìƒì† êµ¬ì¡°
- **CharacterBase**: ëª¨ë“  ìºë¦­í„°ì˜ ê¸°ë³¸ í´ë˜ìŠ¤
- **PlayerCharacter**: í”Œë ˆì´ì–´ ìºë¦­í„° êµ¬í˜„
- **EnemyCharacter**: ì  ìºë¦­í„° êµ¬í˜„

### 2. ë§¤ë‹ˆì € íŒ¨í„´
- **PlayerManager**: í”Œë ˆì´ì–´ ìºë¦­í„° í†µí•© ê´€ë¦¬
- **EnemyManager**: ì  ìºë¦­í„° í†µí•© ê´€ë¦¬
- **PlayerResourceManager**: í”Œë ˆì´ì–´ ë¦¬ì†ŒìŠ¤ ê´€ë¦¬

### 3. ì´ˆê¸°í™” íŒ¨í„´
- **Initializer í´ë˜ìŠ¤ë“¤**: ìºë¦­í„°ë³„ ì´ˆê¸°í™” ë¡œì§
- **Zenject DI**: ì˜ì¡´ì„± ì£¼ì…ì„ í†µí•œ ì´ˆê¸°í™”

### 4. ì´ë²¤íŠ¸ íŒ¨í„´
- **ICharacterDeathListener**: ìºë¦­í„° ì‚¬ë§ ì´ë²¤íŠ¸
- **ìƒíƒœ ë³€ê²½ ì´ë²¤íŠ¸**: ìºë¦­í„° ìƒíƒœ ë³€ê²½ ì•Œë¦¼

## ğŸ”§ ê¸°ìˆ ì  êµ¬í˜„ ì„¸ë¶€ì‚¬í•­

### ì„±ëŠ¥ ìµœì í™”
- **ê°ì²´ í’€ë§**: ìºë¦­í„° ìƒì„±/ì†Œë©¸ ìµœì í™”
- **ì´ë²¤íŠ¸ ê¸°ë°˜**: Update() ìµœì†Œí™”
- **ë©”ëª¨ë¦¬ ê´€ë¦¬**: ë¶ˆí•„ìš”í•œ ì°¸ì¡° í•´ì œ

### ìŠ¤ë ˆë“œ ì•ˆì „ì„±
- **ì‹±ê¸€í†¤ ë§¤ë‹ˆì €**: ìŠ¤ë ˆë“œ ì•ˆì „í•œ ë§¤ë‹ˆì € êµ¬í˜„
- **ìƒíƒœ ë™ê¸°í™”**: ìºë¦­í„° ìƒíƒœ ë³€ê²½ ë™ê¸°í™”

### ë©”ëª¨ë¦¬ ê´€ë¦¬
- **ë¦¬ì†ŒìŠ¤ í•´ì œ**: ìºë¦­í„° ì†Œë©¸ ì‹œ ë¦¬ì†ŒìŠ¤ ì •ë¦¬
- **ì´ë²¤íŠ¸ êµ¬ë… í•´ì œ**: ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë°©ì§€
