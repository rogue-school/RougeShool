---
description: "UtilitySystem ê°œë°œ ê°€ì´ë“œ ë° ê·œì¹™ - Unity 2D ìœ í‹¸ë¦¬í‹° ì‹œìŠ¤í…œ í†µí•© ê´€ë¦¬"
globs: ["Assets/Script/UtilitySystem/**/*.cs"]
rule_id: utility_system_rules
version: 1.2.0
alwaysApply: true
---

# UtilitySystem ê°œë°œ ê·œì¹™

## ğŸ“‹ ì‹œìŠ¤í…œ ê°œìš”
UtilitySystemì€ ê²Œì„ì˜ ìœ í‹¸ë¦¬í‹° ê¸°ëŠ¥ë“¤ì„ ê´€ë¦¬í•˜ëŠ” ì‹œìŠ¤í…œì…ë‹ˆë‹¤. ê²Œì„ í”Œë¡œìš°, DontDestroyOnLoad ê´€ë¦¬, ë“œë¡­ í•¸ë“¤ëŸ¬ ì£¼ì… ë“± ë‹¤ì–‘í•œ ìœ í‹¸ë¦¬í‹° ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤. ì‹±ê¸€í†¤ íŒ¨í„´ì„ í†µí•œ ì „ì—­ ì ‘ê·¼, ì»¨í…ìŠ¤íŠ¸ íŒ¨í„´ì„ í†µí•œ ìƒíƒœ ê´€ë¦¬, ì˜ì¡´ì„± ì£¼ì… íŒ¨í„´ì„ í†µí•œ ëŠìŠ¨í•œ ê²°í•©ì„ ì§€ì›í•©ë‹ˆë‹¤.

### ìµœê·¼ ë³€ê²½(ìš”ì•½)
- **ì‹±ê¸€í†¤ íŒ¨í„´ ì™„ë£Œ**: DontDestroyOnLoadContainer, DropHandlerInjectorì˜ ì „ì—­ ì ‘ê·¼ ì™„ë£Œ
- **ì»¨í…ìŠ¤íŠ¸ íŒ¨í„´ ì™„ë£Œ**: GameContextë¥¼ í†µí•œ í”Œë ˆì´ì–´ ìºë¦­í„° ì„ íƒ ìƒíƒœ ê´€ë¦¬ ì™„ë£Œ
- **ì˜ì¡´ì„± ì£¼ì… íŒ¨í„´ ì™„ë£Œ**: DropHandlerInjectorë¥¼ í†µí•œ ë“œë¡­ í•¸ë“¤ëŸ¬ ìë™ ì£¼ì… ì™„ë£Œ
- **ê²Œì„ í”Œë¡œìš° ê´€ë¦¬ ì™„ë£Œ**: ì”¬ ì „í™˜ ë° ê²Œì„ ìƒíƒœ ê´€ë¦¬ ì™„ë£Œ
- **ìë™ ê´€ë¦¬ ì™„ë£Œ**: ì˜¤ë¸Œì íŠ¸ì˜ ìƒì„±/ì†Œë©¸ ìë™ ê´€ë¦¬ ì™„ë£Œ
- **Zenject DI í†µí•© ì™„ë£Œ**: ëª¨ë“  UtilitySystem ì»´í¬ë„ŒíŠ¸ê°€ ì˜ì¡´ì„± ì£¼ì…ìœ¼ë¡œ ì „í™˜ ì™„ë£Œ

## ğŸ—ï¸ í´ë” êµ¬ì¡° ê·œì¹™
```
UtilitySystem/
â”œâ”€â”€ GameFlow/         # ê²Œì„ í”Œë¡œìš° (3ê°œ íŒŒì¼)
â””â”€â”€ ë£¨íŠ¸/             # ë£¨íŠ¸ ìœ í‹¸ë¦¬í‹° (2ê°œ íŒŒì¼) - ê°„ì†Œí™”ë¨
```

## ğŸ“ ì£¼ìš” ì»´í¬ë„ŒíŠ¸ ê·œì¹™

### GameFlow í´ë” ê·œì¹™ (3ê°œ íŒŒì¼)
- **GameContext.cs**: ê²Œì„ ì»¨í…ìŠ¤íŠ¸ ê´€ë¦¬
- **IGameContext.cs**: ê²Œì„ ì»¨í…ìŠ¤íŠ¸ ì¸í„°í˜ì´ìŠ¤
- **ISceneLoader.cs**: ì”¬ ë¡œë” ì¸í„°í˜ì´ìŠ¤

### ë£¨íŠ¸ í´ë” ê·œì¹™ (2ê°œ íŒŒì¼) - ê°„ì†Œí™”ë¨
- **DontDestroyOnLoadContainer.cs**: DontDestroyOnLoad ì˜¤ë¸Œì íŠ¸ ê´€ë¦¬
- **DropHandlerInjector.cs**: ë“œë¡­ í•¸ë“¤ëŸ¬ ì£¼ì…

## ğŸ¯ ê°œë°œ ê·œì¹™

### 1. ê²Œì„ í”Œë¡œìš° ê´€ë¦¬ ê·œì¹™
- **ê²Œì„ ì»¨í…ìŠ¤íŠ¸**: ê²Œì„ì˜ ì „ì—­ ìƒíƒœ ê´€ë¦¬
- **ì”¬ ë¡œë”©**: ì”¬ ì „í™˜ ë° ë¡œë”© ê´€ë¦¬
- **ìƒíƒœ ì „í™˜**: ê²Œì„ ìƒíƒœ ê°„ ì „í™˜

### 2. DontDestroyOnLoad ê´€ë¦¬ ê·œì¹™
- **ì˜¤ë¸Œì íŠ¸ ë“±ë¡**: DontDestroyOnLoadë¡œ ì„¤ì •í•  ì˜¤ë¸Œì íŠ¸ ë“±ë¡
- **ìë™ ê´€ë¦¬**: ì”¬ ì „í™˜ ì‹œì—ë„ ìœ ì§€ë˜ëŠ” ì˜¤ë¸Œì íŠ¸ ê´€ë¦¬
- **ìƒëª…ì£¼ê¸° ê´€ë¦¬**: ì˜¤ë¸Œì íŠ¸ì˜ ìƒì„±/ì†Œë©¸ ê´€ë¦¬

### 3. ë“œë¡­ í•¸ë“¤ëŸ¬ ì£¼ì… ê·œì¹™
- **ìë™ ì£¼ì…**: ë“œë¡­ í•¸ë“¤ëŸ¬ë¥¼ ìë™ìœ¼ë¡œ ì£¼ì…
- **ì˜ì¡´ì„± ê´€ë¦¬**: ë“œë¡­ í•¸ë“¤ëŸ¬ ê°„ ì˜ì¡´ì„± ê´€ë¦¬
- **ì´ˆê¸°í™”**: ë“œë¡­ í•¸ë“¤ëŸ¬ì˜ ìë™ ì´ˆê¸°í™”

### 4. ë””ìì¸ íŒ¨í„´ ê·œì¹™
- **ì‹±ê¸€í†¤ íŒ¨í„´**: DontDestroyOnLoadContainer, DropHandlerInjectorì˜ ì „ì—­ ì ‘ê·¼
- **ì»¨í…ìŠ¤íŠ¸ íŒ¨í„´**: GameContextë¥¼ í†µí•œ í”Œë ˆì´ì–´ ìºë¦­í„° ì„ íƒ ìƒíƒœ ê´€ë¦¬
- **ì˜ì¡´ì„± ì£¼ì… íŒ¨í„´**: DropHandlerInjectorë¥¼ í†µí•œ ë“œë¡­ í•¸ë“¤ëŸ¬ ìë™ ì£¼ì…
- **ì»¨í…Œì´ë„ˆ íŒ¨í„´**: DontDestroyOnLoadContainerë¥¼ í†µí•œ ì˜¤ë¸Œì íŠ¸ ìƒëª…ì£¼ê¸° ê´€ë¦¬

## ğŸ”§ ì‚¬ìš© ë°©ë²•

### ê¸°ë³¸ ì‚¬ìš©ë²•
```csharp
// GameContextë¥¼ í†µí•œ í”Œë ˆì´ì–´ ìºë¦­í„° ê´€ë¦¬
GameContext gameContext = new GameContext();
PlayerCharacterData characterData = Resources.Load<PlayerCharacterData>("Characters/SwordCharacter");
gameContext.SetPlayerCharacter(characterData);
PlayerCharacterData currentPlayer = gameContext.GetPlayerCharacter();

// DontDestroyOnLoadContainerë¥¼ í†µí•œ ì˜¤ë¸Œì íŠ¸ ìœ ì§€
DontDestroyOnLoadContainer.Instance.RegisterObject(gameObject);
DontDestroyOnLoadContainer.Instance.UnregisterObject(gameObject);

// DropHandlerInjectorë¥¼ í†µí•œ ë“œë¡­ í•¸ë“¤ëŸ¬ ì£¼ì…
DropHandlerInjector.Instance.InjectHandlers();
```

### ë””ìì¸ íŒ¨í„´ ì‚¬ìš©ë²•
```csharp
// ì‹±ê¸€í†¤ íŒ¨í„´ ì‚¬ìš©ë²•
// DontDestroyOnLoadContainer ì‹±ê¸€í†¤ ì ‘ê·¼
DontDestroyOnLoadContainer container = DontDestroyOnLoadContainer.Instance;
container.RegisterObject(gameObject);

// DropHandlerInjector ì‹±ê¸€í†¤ ì ‘ê·¼
DropHandlerInjector injector = DropHandlerInjector.Instance;
injector.InjectHandlers();

// ì»¨í…ìŠ¤íŠ¸ íŒ¨í„´ ì‚¬ìš©ë²•
// GameContextë¥¼ í†µí•œ ìƒíƒœ ê´€ë¦¬
GameContext context = new GameContext();
context.SetPlayerCharacter(playerData);
context.SetCurrentScene("BattleScene");
context.SetGameState(GameState.InCombat);

// ìƒíƒœ ì¡°íšŒ
PlayerCharacterData currentPlayer = context.GetPlayerCharacter();
string currentScene = context.GetCurrentScene();
GameState currentState = context.GetGameState();

// ì˜ì¡´ì„± ì£¼ì… íŒ¨í„´ ì‚¬ìš©ë²•
// DropHandlerInjectorë¥¼ í†µí•œ ìë™ ì˜ì¡´ì„± ì£¼ì…
DropHandlerInjector.Instance.InjectHandlers();

// ì»¨í…Œì´ë„ˆ íŒ¨í„´ ì‚¬ìš©ë²•
// DontDestroyOnLoadContainerë¥¼ í†µí•œ ì˜¤ë¸Œì íŠ¸ ìƒëª…ì£¼ê¸° ê´€ë¦¬
DontDestroyOnLoadContainer.Instance.RegisterObject(gameObject);
DontDestroyOnLoadContainer.Instance.UnregisterObject(gameObject);
```

### ì£¼ìš” í´ë˜ìŠ¤ ë° ë©”ì„œë“œ

#### GameContext í´ë˜ìŠ¤
- **SetPlayerCharacter(PlayerCharacterData characterData)**: í”Œë ˆì´ì–´ ìºë¦­í„° ë°ì´í„° ì„¤ì •
- **GetPlayerCharacter()**: í”Œë ˆì´ì–´ ìºë¦­í„° ë°ì´í„° ì¡°íšŒ
- **SetCurrentScene(string sceneName)**: í˜„ì¬ ì”¬ ì´ë¦„ ì„¤ì •
- **GetCurrentScene()**: í˜„ì¬ ì”¬ ì´ë¦„ ì¡°íšŒ
- **SetGameState(GameState state)**: ê²Œì„ ìƒíƒœ ì„¤ì •
- **GetGameState()**: ê²Œì„ ìƒíƒœ ì¡°íšŒ
- **SceneLoader**: ì”¬ ë¡œë” ì¸ìŠ¤í„´ìŠ¤ (í”„ë¡œí¼í‹°)

#### DontDestroyOnLoadContainer í´ë˜ìŠ¤
- **Instance**: ì‹±ê¸€í†¤ ì¸ìŠ¤í„´ìŠ¤
- **RegisterObject(GameObject obj)**: ì˜¤ë¸Œì íŠ¸ ë“±ë¡ (ì”¬ ì „í™˜ ì‹œ ìœ ì§€)
- **UnregisterObject(GameObject obj)**: ì˜¤ë¸Œì íŠ¸ ë“±ë¡ í•´ì œ

#### DropHandlerInjector í´ë˜ìŠ¤
- **Instance**: ì‹±ê¸€í†¤ ì¸ìŠ¤í„´ìŠ¤
- **InjectHandlers()**: ì”¬ ë‚´ ëª¨ë“  ë“œë¡­ í•¸ë“¤ëŸ¬ì— ì˜ì¡´ì„± ì£¼ì…

#### IGameContext ì¸í„°í˜ì´ìŠ¤
- **SetPlayerCharacter()**: í”Œë ˆì´ì–´ ìºë¦­í„° ì„¤ì •
- **GetPlayerCharacter()**: í”Œë ˆì´ì–´ ìºë¦­í„° ì¡°íšŒ
- **SetCurrentScene()**: í˜„ì¬ ì”¬ ì„¤ì •
- **GetCurrentScene()**: í˜„ì¬ ì”¬ ì¡°íšŒ
- **SetGameState()**: ê²Œì„ ìƒíƒœ ì„¤ì •
- **GetGameState()**: ê²Œì„ ìƒíƒœ ì¡°íšŒ
- **SceneLoader**: ì”¬ ë¡œë” í”„ë¡œí¼í‹°

#### ISceneLoader ì¸í„°í˜ì´ìŠ¤
- **LoadScene(string sceneName)**: ì”¬ ë¡œë“œ
- **LoadSceneAsync(string sceneName)**: ì”¬ ë¹„ë™ê¸° ë¡œë“œ

## ğŸ—ï¸ ì•„í‚¤í…ì²˜ íŒ¨í„´

### 1. ì»¨í…ìŠ¤íŠ¸ íŒ¨í„´
- **GameContext**: í”Œë ˆì´ì–´ ìºë¦­í„° ì„ íƒ ìƒíƒœ ê´€ë¦¬
- **ìƒíƒœ ì „í™˜**: ì»¨í…ìŠ¤íŠ¸ë¥¼ í†µí•œ ìºë¦­í„° ìƒíƒœ ì „í™˜

### 2. ì»¨í…Œì´ë„ˆ íŒ¨í„´
- **DontDestroyOnLoadContainer**: ì”¬ ì „í™˜ ì‹œì—ë„ ìœ ì§€ë˜ëŠ” ì˜¤ë¸Œì íŠ¸ ê´€ë¦¬
- **ìë™ ê´€ë¦¬**: ì˜¤ë¸Œì íŠ¸ì˜ ìƒì„±/ì†Œë©¸ ìë™ ê´€ë¦¬

### 3. ì˜ì¡´ì„± ì£¼ì… íŒ¨í„´
- **DropHandlerInjector**: ë“œë¡­ í•¸ë“¤ëŸ¬ ìë™ ì£¼ì…
- **ì¸í„°í˜ì´ìŠ¤ ê¸°ë°˜**: ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•œ ëŠìŠ¨í•œ ê²°í•©

### 4. ì‹±ê¸€í†¤ íŒ¨í„´
- **DontDestroyOnLoadContainer**: ì „ì—­ ì˜¤ë¸Œì íŠ¸ ê´€ë¦¬
- **DropHandlerInjector**: ì „ì—­ ë“œë¡­ í•¸ë“¤ëŸ¬ ì£¼ì…

## ğŸ”§ ê¸°ìˆ ì  êµ¬í˜„ ì„¸ë¶€ì‚¬í•­

### ì„±ëŠ¥ ìµœì í™”
- **ë©”ëª¨ë¦¬ ê´€ë¦¬**: ì˜¤ë¸Œì íŠ¸ í’€ë§ì„ í†µí•œ GC ì••ë°• ìµœì†Œí™”
- **í”„ë ˆì„ ìµœì í™”**: ì”¬ ì „í™˜ ì‹œ í”„ë ˆì„ ë¸”ë¡œí‚¹ ë°©ì§€
- **ë¡œë”© ìµœì í™”**: ë¹„ë™ê¸° ì”¬ ë¡œë”©

### ìŠ¤ë ˆë“œ ì•ˆì „ì„±
- **ë™ì‹œì„± ì œì–´**: ì˜¤ë¸Œì íŠ¸ ë“±ë¡/í•´ì œ ì‹œ ë™ì‹œì„± ì œì–´
- **ë¹„ë™ê¸° ì²˜ë¦¬**: async/await íŒ¨í„´ì„ í†µí•œ ë¹„ë™ê¸° ì”¬ ë¡œë”©
- **ì´ë²¤íŠ¸ ì²˜ë¦¬**: ìŠ¤ë ˆë“œ ì•ˆì „í•œ ìœ í‹¸ë¦¬í‹° ì´ë²¤íŠ¸ ì‹œìŠ¤í…œ

### ë©”ëª¨ë¦¬ ê´€ë¦¬
- **ìƒëª…ì£¼ê¸° ê´€ë¦¬**: ì˜¤ë¸Œì íŠ¸ì˜ ìƒì„±/ì†Œë©¸ ê´€ë¦¬
- **ë¦¬ì†ŒìŠ¤ í•´ì œ**: ì”¬ ì „í™˜ ì‹œ ë¦¬ì†ŒìŠ¤ ì •ë¦¬
- **ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë°©ì§€**: ì´ë²¤íŠ¸ êµ¬ë… í•´ì œ, ì˜¤ë¸Œì íŠ¸ ì°¸ì¡° í•´ì œ
