---
alwaysApply: true
description: "RougeShool 프로젝트의 코드 품질을 보장하기 위한 구체적인 검증 기준과 품질 게이트를 정의합니다. 심각도별 검증 기준, 자동화 체크리스트, 품질 메트릭 기준을 포함합니다."
---
## 🔍 자동화 체크리스트

### 📋 **코드 생성 시 필수 체크리스트**

#### **1. 기본 검증**
- [ ] **null 체크**: 모든 public 메서드에서 null 체크 완료
- [ ] **예외 처리**: try-catch 블록으로 예외 상황 처리
- [ ] **로깅**: 모든 에러와 중요한 이벤트에 GameLogger 사용
- [ ] **한국어**: 모든 사용자 메시지와 로그가 한국어로 작성
- [ ] **XML 문서화**: public 메서드와 클래스에 XML 문서화 완료

#### **2. Unity 특화 검증**
- [ ] **MonoBehaviour 생명주기**: OnEnable/OnDisable에서 이벤트 구독/해제
- [ ] **컴포넌트 참조**: GetComponent 호출 결과 null 체크
- [ ] **씬 전환**: DontDestroyOnLoad 설정이 필요한 오브젝트 확인
- [ ] **프리팹 참조**: SerializeField로 할당된 프리팹 참조 확인

#### **3. 프로젝트 특화 검증**
- [ ] **Zenject DI**: 적절한 바인딩과 스코프 설정
- [ ] **DOTween Pro**: 애니메이션 완료 시 정리 코드 포함
- [ ] **CoreSystem**: ICoreSystemInitializable 구현 확인
- [ ] **기존 코드 우선**: 새로운 기능보다 기존 코드 개선 우선

#### **4. 성능 검증**
- [ ] **오브젝트 풀링**: 자주 생성/삭제되는 오브젝트에 풀링 적용
- [ ] **캐싱**: 반복 계산되는 값에 캐싱 적용
- [ ] **Update 최적화**: 매 프레임 실행되는 코드 최소화
- [ ] **메모리 관리**: 불필요한 메모리 할당 방지

---

## 📊 품질 메트릭 기준

### 🎯 **코드 복잡도 기준**
```csharp
// ✅ 좋은 예: 단순하고 명확한 메서드
public bool CanPlayCard(SkillCard card)
{
    if (card == null) return false;
    if (!card.IsAvailable) return false;
    if (player.CurrentMana < card.ManaCost) return false;
    
    return true;
}

// ❌ 나쁜 예: 복잡하고 긴 메서드
public void ProcessCombatTurn()
{
    // 50줄 이상의 복잡한 로직...
    // 여러 책임을 가진 메서드
    // 테스트하기 어려운 구조
}
```

### 🎯 **테스트 가능성 기준**
```csharp
// ✅ 좋은 예: 의존성 주입으로 테스트 가능
public class CardProcessor
{
    private readonly IPlayerManager playerManager;
    private readonly IAudioManager audioManager;
    
    public CardProcessor(IPlayerManager playerManager, IAudioManager audioManager)
    {
        this.playerManager = playerManager;
        this.audioManager = audioManager;
    }
    
    public bool ProcessCard(SkillCard card)
    {
        // 테스트 가능한 로직
    }
}

// ❌ 나쁜 예: 직접 의존성으로 테스트 어려움
public class CardProcessor
{
    public bool ProcessCard(SkillCard card)
    {
        var player = FindObjectOfType<PlayerCharacter>(); // 테스트 어려움
        var audio = FindObjectOfType<AudioManager>();     // 테스트 어려움
        
        // 로직...
    }
}
```

---

## 🚫 절대 금지사항

### 🔴 **런타임 에러 위험**
- null 참조 예외 가능성
- 배열/리스트 인덱스 초과
- 타입 캐스팅 실패 가능성
- 무한 루프 가능성

### 🔴 **메모리 누수 위험**
- 이벤트 구독 해제 누락
- DOTween 애니메이션 정리 누락
- 오브젝트 풀링 미사용
- 캐시 크기 제한 없음

### 🔴 **성능 저하 위험**
- 매 프레임 FindObjectOfType 호출
- 매 프레임 무거운 계산
- 불필요한 오브젝트 생성
- 메모리 할당 최적화 부족

### 🔴 **아키텍처 위반**
- SOLID 원칙 위반
- 의존성 역전 원칙 위반
- 단일 책임 원칙 위반
- 기존 코드 중복 생성

---

## 🔧 품질 검증 도구

### 📋 **자동 검증 스크립트**
```csharp
// 코드 품질 자동 검증을 위한 확장 메서드
public static class QualityValidationExtensions
{
    public static bool ValidateNullSafety(this object obj, string objectName)
    {
        if (obj == null)
        {
            GameLogger.LogError($"{objectName}이 null입니다", GameLogger.LogCategory.Error);
            return false;
        }
        return true;
    }
    
    public static bool ValidateComponent<T>(this GameObject gameObject) where T : Component
    {
        var component = gameObject.GetComponent<T>();
        if (component == null)
        {
            GameLogger.LogError($"{gameObject.name}에 {typeof(T).Name} 컴포넌트가 없습니다", GameLogger.LogCategory.Error);
            return false;
        }
        return true;
    }
}
```

### 📋 **성능 모니터링**
```csharp
public class PerformanceMonitor : MonoBehaviour
{
    private Dictionary<string, float> operationTimes = new Dictionary<string, float>();
    
    public void StartOperation(string operationName)
    {
        operationTimes[operationName] = Time.realtimeSinceStartup;
    }
    
    public void EndOperation(string operationName)
    {
        if (operationTimes.ContainsKey(operationName))
        {
            float duration = Time.realtimeSinceStartup - operationTimes[operationName];
            
            if (duration > 0.016f) // 60fps 기준
            {
                GameLogger.LogWarning($"성능 이슈: {operationName} ({duration:F3}초)", GameLogger.LogCategory.Performance);
            }
            
            operationTimes.Remove(operationName);
        }
    }
}
```

---

## 📋 최종 검증 체크리스트

### ✅ **코드 제출 전 필수 확인사항**
- [ ] 모든 public 메서드에 null 체크 적용
- [ ] 모든 예외 상황에 대한 처리 완료
- [ ] GameLogger를 통한 적절한 로깅 완료
- [ ] 한국어 메시지 및 문서화 완료
- [ ] XML 문서화 완료
- [ ] 성능 최적화 기법 적용
- [ ] 메모리 누수 방지 코드 적용
- [ ] 기존 코드와의 일관성 확인
- [ ] SOLID 원칙 준수 확인
- [ ] 테스트 가능한 구조로 설계

### ⚠️ **자동 거부 기준**
- 런타임 에러 위험이 있는 코드
- 메모리 누수 가능성이 있는 코드
- 심각한 성능 이슈가 있는 코드
- 아키텍처 원칙을 위반하는 코드
- 기존 코드와 중복되는 기능

---

## 🎯 품질 목표

### 📊 **정량적 목표**
- **코드 커버리지**: 최소 80% 이상
- **순환 복잡도**: 메서드당 최대 10 이하
- **메모리 사용량**: 씬당 최대 500MB 이하
- **프레임 레이트**: 최소 60fps 유지
- **로딩 시간**: 씬 전환 3초 이하

### 📊 **정성적 목표**
- **가독성**: 다른 개발자가 쉽게 이해할 수 있는 코드
- **유지보수성**: 변경사항을 쉽게 적용할 수 있는 구조
- **확장성**: 새로운 기능을 쉽게 추가할 수 있는 설계
- **안정성**: 예외 상황에서도 안정적으로 동작
- **일관성**: 프로젝트 전체의 코딩 스타일 일관성